Europa Engine Patcher Ver 0.50

■はじめに
  Paradox社のEuropa Engineを使用したゲームを日本語化するためのツールです。
  TObject様のparadox JP-Patcherを全面的に参考にしています。

■適用対象
  - Crusader Kings Deus Vult 2.1beta
  - Europa Universalis 1.09
  - For the Glory 1.2
  - Victoria Revolutions 2.01 Hotfix 6
  - Hearts of Iron 1.06c
  - Hearts of Iron 2 Doomsday Armageddon 1.2/1.3beta2 Hotfix
  - Arsenal of Democracy 1.04/1.07/1.08
  - Darkest Hour 1.02/1.03

■使用方法
  1. 以下のランタイムライブラリをインストールして下さい。
     Microsoft .NET Framework 3.5 Service Pack 1 (フル パッケージ)
       http://www.microsoft.com/ja-jp/download/details.aspx?id=25150
  2. EuropaEnginePatcher.exeを起動します。
  3. ツールのウィンドウにゲームの実行ファイルをドロップします。
  4. しばらく待つと「成功しました。」と表示されるのでツールを終了して下さい。
  5. 日本語化ファイル一式をゲームフォルダへ上書きコピーし、ゲームを開始して下さい。

■オプション
  - 自動処理モード
      ウィンドウへゲームの実行ファイルをドロップ、ゲームの実行ファイルを参照して選択、
      開始キーを押した時にパッチ当て、保存、日本語化DLLのコピーを連続して行います。
  - 元のファイルをリネーム
      チェックを入れると元のファイルを〜En.exeに変更し、
      パッチを当てた後のファイルで元のファイルを置き換えます。
      チェックを入れていないとパッチを当てた後のファイルを〜Jp.exeで保存し、
      元のファイルを変更しません。(Ver0.46以前の動作)
  - テキスト自動折り返し
      文字列が表示幅を超える場合に自動改行します。
      ある程度の禁則処理も行います。
      これを有効にすれば、日本語版用のMODもそのまま使えるはずです。
  - 自動命名時の語順変更
      ユニット名のストックが切れて自動で命名される時に、
      「第1歩兵師団」のように日本語の語順で命名することを可能にします。
      和訳テキスト側の対応が必要ですので、和訳側での対応が完了しているか、
      下の説明を読んで理解できる人のみチェックを入れて下さい。
  - 強制ウィンドウ化
      強制的にウィンドウモードで起動するようにします。
      一旦パッチを当てるとフルスクリーンモードに戻せません。
      フルスクリーンに戻したい時にはパッチを当て直して下さい。
      DDA版Iron Crossではゲーム付属のツールで変更できるのでこの設定は無視されます。

■注意事項
  1. ツールの使用は自己責任でお願いします。何かあった時には元の状態に戻せるように!
  2. オリジナルのファイルを上書きしないように、バックアップを取っておきましょう。
  3. 基本的に拡張パック導入済みの最新版でしか動作検証していません。

■和訳作者様向け連絡事項
  1. DHの研究概要画面で最大上陸規模の項目にゴミが表示される問題を解消するため、
     定義名をEE_MAX_AMPHIB_MOD_TITLEに変更しています。
     configファイルのどこかに以下の定義を追加して下さい。
----- ここから
EE_MAX_AMPHIB_MOD_TITLE;上陸戦最大規模;Max amphibious size;;;;;;;;;X
----- ここまで
  2. Vic/HoI/HoI2/AoD/DHでユニット自動命名時に日本語の語順になるよう
     埋め込み文字列を変更する機能を提供しました。
     利用される場合は、和訳テキストの以下の定義を変更して下さい。
----- ここから
0TH;第;th;;;;;;;;;X
1ST;第;st;;;;;;;;;X
2ND;第;nd;;;;;;;;;X
3TH;第;rd;;;;;;;;;X
4TH;第;th;;;;;;;;;X
5TH;第;th;;;;;;;;;X
6TH;第;th;;;;;;;;;X
7TH;第;th;;;;;;;;;X
8TH;第;th;;;;;;;;;X
9TH;第;th;;;;;;;;;X
3RD;第;rd;;;;;;;;;X
1TH;第;th;;;;;;;;;X
2TH;第;th;;;;;;;;;X
----- ここまで
     定義の場所は、以下のようにゲームにより異なります。
       Vic/HoI/HoI2: config/text.csv
       AoD: config/boostertext.csv および config/text.csv
       DH: config/text.csv および Mods/Darkest Hour Full/config/text.csv
     また、Victoriaの場合は国家序列の序数を分離しましたので、
     configファイルのどこかに以下の定義も追加して下さい。
----- ここから
RANKING_SUFFIX;位;;;;;;;;;;X
----- ここまで
  3. オリジナルの_inmm.iniから以下の指定を追加しています。
     MaxLines=[行数]
       文字幅計算処理を指定行数で打ち切ります。
       HoI2系で巨大タワーにカーソルを合わせるとパフォーマンスが著しく低下する問題の対策です。
       デフォルトは84行です。
       指定行数で打ち切った時に文字列終端をセットしますので、以降の行は表示されなくなります。
     MaxWordChars=[文字数]
       色指定後の分離禁則処理、連数字の分離禁則処理を指定バイト数で打ち切ります。
       FtGの外交画面等で色指定された文字列が表示幅を超えると落ちる問題の対策です。
       2バイト文字は2文字として扱います。
       デフォルトは24文字です。

■制約事項
  1. Steam版には対応していません。(解決不能)
     プログラム部分が圧縮or暗号化されてており、パッチを当てる位置が判別できないためです。
     DHなどゲームの種類によっては動作するものがありますが、
     作者が検証できない以上サポート外とします。
     Steam版の日本語化方法に関する質問には答えられません。
  2. チャットウィンドウで日本語変換中にCtrlキーを押すと文字化けします。

■更新履歴
  2013/12/23 Ver 0.50   自動処理モードを実装。
                        英語版のファイルをリネームするモードを追加。
                        強制ウィンドウ化機能を実装。
                        _inmm.dllがVCランタイムに依存しないように改良。
  2013/05/04 Ver 0.45   チャットウィンドウの文字化け問題を一部修正。
  2013/03/20 Ver 0.44   0.42の変更により発生したDDA1.2およびIC/DDAのパッチ当てに失敗する不具合を修正。
  2012/10/06 Ver 0.43   DH1.03RC1に対応。
  2012/09/23 Ver 0.42   DH/AoD/DDAで研究概要タブのモデル名が中途半端な位置で打ち切られる問題に対処。
  2012/07/08 Ver 0.41   AoD1.08にて技術の史実年度が技術名と重なって表示される問題を修正。
  2012/07/01 Ver 0.40   巨大タワーにカーソルを合わせた時の反応改善。
                        実行ファイルはバージョン変更のみ。
  2012/07/01 Ver 0.39   色指定後の分離禁則処理でバッファ計算処理に誤りがあったのを修正。
                        0.35よりVictoriaで自動改行処理が動作していなかったのを修正。
  2012/06/23 Ver 0.38   AoD1.08b6でのバイナリ変更に追従。
                        公式対応により河川ツールチップの日本語化を廃止。
  2012/06/13 Ver 0.37   AoD1.08b5の河川ツールチップを日本語化できるようにした。
                        0.36の変更により発生したEU2のメッセージ設定画面で落ちる不具合を修正。
                        微妙にログ出力内容修正。
  2012/05/27 Ver 0.36   AoD1.04/1.08b3に対応。
                        1.04/1.07/1.08の差異を自動認識するようにした。
                        共通化のため、微妙にパッチ内容変更。
  2012/02/29 Ver 0.35   EU2/FtGで折り返し処理を実装。
                        HoIで語順変更/折り返し処理を実装。
                        _inmm.dllの細かな効率化。
                        0.34の効率化により発生した不具合を修正。
  2012/02/26 Ver 0.34   _inmm.dllの効率化。
                        これにより、巨大タワーにカーソルを合わせた時の反応を改善した。
                        実行ファイルはバージョン変更のみ。
  2012/02/12 Ver 0.33   Victoriaで語順変更設定時に国家序列の表示が変になるので定義を分離。
                        和訳側の対応に伴い、DHで語順変更をデフォルト設定に変更。
                        微妙にインターフェース改良。
  2012/02/04 Ver 0.32   CKで折り返し処理を実装。
                        数字の分離禁則処理対象に小数点等の記号を含めるように修正。
                        色指定文字列の途中で極力改行しないようにロジック変更。
                        これに伴い、HoI2/AoD/DHの諜報画面/外交画面も折り返し処理を有効にした。
                        ゲーム自動判別時にオプションのデフォルト値を設定するよう変更。
  2012/01/30 Ver 0.31   メッセージログ画面の折り返し処理を実装。
                        Victoriaで語順変更/折り返し処理を実装。
                        微妙にインターフェース改良。
  2012/01/28 Ver 0.30   折り返し処理時に色指定コマンドの途中で分断される不具合修正。
                        メッセージ設定画面の折り返し処理を作成。
                        _inmm.dllに禁則文字判定処理を追加。
                        パッチを当てた実行ファイルの保存後に_inmm.dllをコピーする機能を追加。
                        _inmm.dllの細かな効率化。
                        HoI2でウィンドウ化した時に誤動作する問題が何故か発生しなくなった。
  2012/01/21 Ver 0.29   HoI2/AoD/DHでユニット自動命名時の語順変更に正式対応。
                        HoI2/AoD/DHで折り返し処理に対応。
                        _inmm.dllの細かなバグ修正/効率化。
  2012/01/15 Ver 0.21   DHのユニット自動命名時の語順入れ替え対応。
  2012/01/09 Ver 0.20   CK/EU2/FtG/Vic/HoIについてもクリッピング処理に対応。
                        _inmm.dllの細かなバグ修正/効率化。
                        FtG用コイン画像対応。
  2012/01/07 Ver 0.19   クリッピング処理対応。
                        _inmm.dllを自製化。
  2011/05/03 Ver 0.12   DHの研究概要画面で最大上陸規模の項目にゴミが表示される問題に暫定対応。
  2011/04/10 Ver 0.11   CK/EU2/FtG/Vic/HoIに対応。
  2011/04/08 Ver 0.10   DarkestHourに正式対応。
                        おまけでHoI2にも対応。
                        HoI2/AoD1.05以降/DarkestHourを自動認識する仕掛けを作成。
                        名称をEuropa Engine Patcherに変更。
  2011/04/06 Ver 0.06   DarkestHour対応暫定版を公開。
  2010/09/24 Ver 0.05   AoD1.05に対応。
  2010/05/19 Ver 0.04   強制大文字化回避のパッチ方法をHoI2英語版日本語化の方法に合わせた。
                        微妙にインターフェース改良(DnDに対応)
  2010/03/29 Ver 0.03   一部文字化けが残っていたのを修正
  2010/03/26 Ver 0.02   文字化けを修正/エラーチェックを(少し)実装
  2010/03/20 Ver 0.01   AoDJpPatcherとして初版公開

■最後に
  paradox JP-Patcherを作成されたTObject様に感謝を捧げます。
  最初に作られた時が最も大変だったということを実感しました。
